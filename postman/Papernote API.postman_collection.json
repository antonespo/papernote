{
  "info": {
    "_postman_id": "papernote-api-collection",
    "name": "Papernote API Collection",
    "description": "Complete collection for testing Papernote Auth and Notes API endpoints",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Auth API",
      "item": [
        {
          "name": "Register",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"testuser\",\n  \"password\": \"SecurePassword123!\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{authBaseUrl}}/api/v1/auth/register",
              "host": ["{{authBaseUrl}}"],
              "path": ["api", "v1", "auth", "register"]
            },
            "description": "Register a new user account"
          },
          "response": []
        },
        {
          "name": "Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    pm.environment.set('accessToken', response.accessToken);",
                  "    pm.environment.set('refreshToken', response.refreshToken);",
                  "    pm.environment.set('userId', response.user.id);",
                  "    console.log('Tokens saved to environment');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"testuser\",\n  \"password\": \"SecurePassword123!\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{authBaseUrl}}/api/v1/auth/login",
              "host": ["{{authBaseUrl}}"],
              "path": ["api", "v1", "auth", "login"]
            },
            "description": "Login with username and password"
          },
          "response": []
        },
        {
          "name": "Refresh Token",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    pm.environment.set('accessToken', response.accessToken);",
                  "    pm.environment.set('refreshToken', response.refreshToken);",
                  "    console.log('New tokens saved to environment');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"refreshToken\": \"{{refreshToken}}\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{authBaseUrl}}/api/v1/auth/refresh",
              "host": ["{{authBaseUrl}}"],
              "path": ["api", "v1", "auth", "refresh"]
            },
            "description": "Refresh access token using refresh token"
          },
          "response": []
        },
        {
          "name": "Logout",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userId\": \"{{userId}}\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{authBaseUrl}}/api/v1/auth/logout",
              "host": ["{{authBaseUrl}}"],
              "path": ["api", "v1", "auth", "logout"]
            },
            "description": "Logout and invalidate current refresh token"
          },
          "response": []
        },
        {
          "name": "Revoke All Tokens",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userId\": \"{{userId}}\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{authBaseUrl}}/api/v1/auth/revoke-all",
              "host": ["{{authBaseUrl}}"],
              "path": ["api", "v1", "auth", "revoke-all"]
            },
            "description": "Revoke all refresh tokens for the user"
          },
          "response": []
        }
      ],
      "description": "Authentication endpoints for user registration, login, logout, and token management"
    },
    {
      "name": "User Resolution API (Internal)",
      "item": [
        {
          "name": "Get User ID by Username",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{authBaseUrl}}/api/internal/users/resolve/username/{{testUsername}}",
              "host": ["{{authBaseUrl}}"],
              "path": [
                "api",
                "internal",
                "users",
                "resolve",
                "username",
                "{{testUsername}}"
              ]
            },
            "description": "Resolve username to user ID (internal service-to-service call)"
          },
          "response": []
        },
        {
          "name": "Get Username by User ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{authBaseUrl}}/api/internal/users/resolve/userid/{{userId}}",
              "host": ["{{authBaseUrl}}"],
              "path": [
                "api",
                "internal",
                "users",
                "resolve",
                "userid",
                "{{userId}}"
              ]
            },
            "description": "Resolve user ID to username (internal service-to-service call)"
          },
          "response": []
        },
        {
          "name": "Batch Resolve Usernames to User IDs",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"usernames\": [\"testuser\", \"anotheruser\", \"thirduser\"]\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{authBaseUrl}}/api/internal/users/resolve/batch/usernames",
              "host": ["{{authBaseUrl}}"],
              "path": [
                "api",
                "internal",
                "users",
                "resolve",
                "batch",
                "usernames"
              ]
            },
            "description": "Batch resolve multiple usernames to user IDs (internal service-to-service call)"
          },
          "response": []
        },
        {
          "name": "Batch Resolve User IDs to Usernames",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userIds\": [\"{{userId}}\", \"00000000-1111-2222-3333-444444444444\"]\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{authBaseUrl}}/api/internal/users/resolve/batch/userids",
              "host": ["{{authBaseUrl}}"],
              "path": [
                "api",
                "internal",
                "users",
                "resolve",
                "batch",
                "userids"
              ]
            },
            "description": "Batch resolve multiple user IDs to usernames (internal service-to-service call)"
          },
          "response": []
        }
      ],
      "description": "Internal user resolution endpoints for service-to-service communication"
    },
    {
      "name": "Notes API",
      "item": [
        {
          "name": "Get All Notes",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{notesBaseUrl}}/api/v1/notes",
              "host": ["{{notesBaseUrl}}"],
              "path": ["api", "v1", "notes"]
            },
            "description": "Retrieve all notes for the authenticated user"
          },
          "response": []
        },
        {
          "name": "Get Note by ID",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{notesBaseUrl}}/api/v1/notes/{{noteId}}",
              "host": ["{{notesBaseUrl}}"],
              "path": ["api", "v1", "notes", "{{noteId}}"]
            },
            "description": "Retrieve a specific note by its ID"
          },
          "response": []
        },
        {
          "name": "Create Note",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"My First Note\",\n  \"content\": \"This is the content of my first note. It contains important information.\",\n  \"tags\": [\"work\", \"important\", \"todo\"]\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{notesBaseUrl}}/api/v1/notes",
              "host": ["{{notesBaseUrl}}"],
              "path": ["api", "v1", "notes"]
            },
            "description": "Create a new note"
          },
          "response": []
        },
        {
          "name": "Update Note",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"id\": \"{{noteId}}\",\n  \"title\": \"Updated Note Title\",\n  \"content\": \"This is the updated content of the note with more details and information.\",\n  \"tags\": [\"work\", \"updated\", \"important\"]\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{notesBaseUrl}}/api/v1/notes/{{noteId}}",
              "host": ["{{notesBaseUrl}}"],
              "path": ["api", "v1", "notes", "{{noteId}}"]
            },
            "description": "Update an existing note"
          },
          "response": []
        },
        {
          "name": "Delete Note",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "DELETE",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{notesBaseUrl}}/api/v1/notes/{{noteId}}",
              "host": ["{{notesBaseUrl}}"],
              "path": ["api", "v1", "notes", "{{noteId}}"]
            },
            "description": "Delete a note by ID"
          },
          "response": []
        },
        {
          "name": "Search Notes - Text Only",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{notesBaseUrl}}/api/v1/notes/search?text=important information",
              "host": ["{{notesBaseUrl}}"],
              "path": ["api", "v1", "notes", "search"],
              "query": [
                {
                  "key": "text",
                  "value": "important information",
                  "description": "Full-text search query"
                }
              ]
            },
            "description": "Search notes by text content using PostgreSQL full-text search"
          },
          "response": []
        },
        {
          "name": "Search Notes - Tags Only",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{notesBaseUrl}}/api/v1/notes/search?tags=work,important",
              "host": ["{{notesBaseUrl}}"],
              "path": ["api", "v1", "notes", "search"],
              "query": [
                {
                  "key": "tags",
                  "value": "work,important",
                  "description": "Comma-separated list of tags to search for"
                }
              ]
            },
            "description": "Search notes by tags"
          },
          "response": []
        },
        {
          "name": "Search Notes - Text and Tags",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{notesBaseUrl}}/api/v1/notes/search?text=meeting&tags=work,urgent",
              "host": ["{{notesBaseUrl}}"],
              "path": ["api", "v1", "notes", "search"],
              "query": [
                {
                  "key": "text",
                  "value": "meeting",
                  "description": "Full-text search query"
                },
                {
                  "key": "tags",
                  "value": "work,urgent",
                  "description": "Comma-separated list of tags to search for"
                }
              ]
            },
            "description": "Search notes by both text content and tags"
          },
          "response": []
        }
      ],
      "description": "Notes CRUD operations and search functionality"
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [""]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [""]
      }
    }
  ],
  "variable": [
    {
      "key": "authBaseUrl",
      "value": "https://localhost:7001",
      "type": "string",
      "description": "Base URL for Auth API service"
    },
    {
      "key": "notesBaseUrl",
      "value": "https://localhost:7002",
      "type": "string",
      "description": "Base URL for Notes API service"
    },
    {
      "key": "noteId",
      "value": "00000000-0000-0000-0000-000000000000",
      "type": "string",
      "description": "Sample note ID for testing"
    },
    {
      "key": "userId",
      "value": "",
      "type": "string",
      "description": "User ID - automatically set after login"
    },
    {
      "key": "accessToken",
      "value": "",
      "type": "string",
      "description": "JWT access token - automatically set after login"
    },
    {
      "key": "refreshToken",
      "value": "",
      "type": "string",
      "description": "Refresh token - automatically set after login"
    },
    {
      "key": "testUsername",
      "value": "testuser",
      "type": "string",
      "description": "Test username for user resolution endpoints"
    }
  ]
}
